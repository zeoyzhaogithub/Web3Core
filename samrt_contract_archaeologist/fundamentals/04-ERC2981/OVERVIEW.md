# ERC2981标准全面解析：目的、原理、应用

## 一、协议概述

ERC-2981 是以太坊社区提出的一个为NFT（非同质化代币）实现链上版税标准（Royalty Standard）协议。

旨在NFT创作者能够在每一次二级市场交易中，自动、透明地获得分成收入。

* 提案编号：EIP-2981
* 标准定义：NFT 在被出售时，提供一套接口供市场查询应付版税信息。
* 典型支持平台：OpenSea、Rarible、LooksRare、Foundation、SuperRare 等。

## 二、 目的：为什么需要ERC-2981

在ERC-2981出现之前，NFT生态面临一个严峻的问题：**如何为创作者/原创项目方实现可持续的、自动化的版税收入？**

* **没有统一标准**：最初的 NFT 标准（如 ERC-721）只定义了如何创建和转移代币，**并没有规定如何支付版税**。
* **依赖平台善意**：版税支付完全由像 OpenSea 这样的交易平台在**链下自行处理**。平台会根据自己设置的规则，在交易完成后手动将一部分销售额转给创作者。
* **带来的弊端**：
    1. **不确定性**：如果某个平台决定不支付或降低版税，创作者无能为力。
    2. **不透明**：版税支付过程不在链上，难以追踪和验证。
    3. **可绕过**：用户可以通过直接与合约交互来转移 NFT，从而绕过市场的版税支付逻辑。

**ERC-2981 的目的就是为了解决这些问题，将版税信息变成 NFT 智能合约内在的、链上的、可编程的规则。**

## 三、 核心原理

ERC-2981 的设计非常简洁优雅。它的核心是一个名为**`royaltyInfo`** 的标准化函数。

任何支持 ERC-2981 的市场（如 OpenSea、Blur）在完成一笔 NFT 交易前，都会自动调用这个函数来查询版税信息。

**工作流程分解：**

1. **交易发生**：小明在 NFT 市场上以 1 ETH 的价格出售一个 NFT。
2. **市场查询**：市场准备执行交易时，会向该 NFT 的智能合约发起查询，调用 `royaltyInfo` 函数，并传入两个参数：
    * `tokenId`：正在出售的 NFT 的 ID。
    * `salePrice`：销售价格（本例中是 1 ETH）。
3. **合约响应**：NFT 合约根据预设的规则（例如，版税为销售价的 5%）进行计算，并返回两个信息：
    * `receiver`：版税接收者的地址（例如，创作者的钱包地址）。
    * `royaltyAmount`：应支付的版税金额（本例中是 0.05 ETH）。
4. **自动支付**：市场在完成主交易（将 0.95 ETH 转给卖家小明）的同时，**自动地**将 0.05 ETH 转给创作者的钱包。

这个过程完全自动化且在链上进行，确保了透明和可靠。
