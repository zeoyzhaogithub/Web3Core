# 函数输出

在 Solidity 中，函数输出（返回值）是函数执行后返回给调用者的数据。

## 1. 基本语法

### 单返回值

```solidity
function add(uint a, uint b) public pure returns (uint) {
    return a + b;
}
```

### 多返回值

```solidity
function math(uint a, uint b) public pure
    returns (uint sum, uint product, uint difference)
{
    sum = a + b;
    product = a * b;
    difference = a - b;
}
```

## 2. 返回值特性

### a) 命名返回值

在 returns 中声明变量名后，可直接赋值（无需显式 return）：

```solidity
function namedReturn() public pure returns (uint x, bool success) {
    x = 10;
    success = true;
    // 自动返回 (x, success)
}
```

### b) 动态类型返回

动态数组/字符串需指定内存位置：

```solidity
function getArray() public pure returns (uint[] memory) {
    uint[] memory arr = new uint[](3);
    arr[0] = 1;
    return arr;
}

function getString() public pure returns (string memory) {
    return "Hello";
}
```

### c) 结构体返回

需声明 memory 或 storage（视情况）：

```solidity
struct User {
    uint id;
    string name;
}

function getUser() public pure returns (User memory) {
    return User(1, "Alice");
}
```

## 3. 调用端处理返回值

### a) 全接收模式

```solidity
(uint s, uint p, ) = math(3, 4); // 忽略第三个返回值
```

### b) 部分接收模式

```solidity
(, uint product, ) = math(3, 4); // 仅取乘积
```

### c) 外部调用处理

在合约外部调用时（如 Web3.js），返回值以数组形式返回：

```javascript
const result = await contract.math(3, 4);
console.log(result[0]); // 输出 sum
```

## 4. 重要规则与限制

### 位置声明

返回动态类型（数组/字符串）时必须使用 memory 或 calldata（0.6.0+），不可省略。

### return 可选性

若已命名返回值，可直接赋值；显式 return 时需返回完整值列表。

### Gas 消耗

返回数据量越大，Gas 成本越高（尤其是动态类型）。

### 外部调用限制

external 函数无法返回结构体（需编译器版本 ≥0.8.0）。

## 5. 最佳实践

### 明确命名返回值：增强代码可读性

```solidity
returns (uint sum, uint product)
```

### 避免大型数据返回

大数组可能耗尽 Gas，改用事件日志或分页查询

### 校验返回值

调用外部函数时检查关键返回值（如 bool success）

示例：综合使用

```solidity
function compute(uint a, uint b)
    public pure
    returns (uint sum, uint product, string memory message)
{
    sum = a + b;
    product = a * b;
    message = "Calculation done";
}

// 调用
(uint x, , string memory msg) = compute(2, 3); // 只接收 sum 和 message
```
