# Foundry介绍和安装

## Foundry 简介

Foundry 是由 Paradigm 团队开发的下一代以太坊开发环境，采用 Rust 编写，以其极速性能和原生 Solidity 工作流颠覆传统开发工具（如 Hardhat/Truffle）。

Paradigm是一家知名的风险投资公司，专注于区块链技术和加密货币领域。Foundry的诞生旨在为silidity智能合约开发、测试和部署提供一个高效、现代的工具集，帮助开发者更凯苏地构建安全可靠的区块链应用程序。

Foundry 是一个现代化的以太坊开发工具链（DevOps Toolkit），专为智能合约开发设计，由 Rust 编写。它包含以下核心组件：

### Forge- 智能合约引擎

智能合约测试框架（类似 Truffle/Hardhat），支持：

- Solidity 单元测试（直接在 .sol 文件中写测试）

- Fuzz Testing（模糊测试）

- Invariant Testing（不变性测试）

- Gas 消耗报告

- 闪电贷模拟

### Cast

命令行工具，用于与 EVM 链交互：

- 发送交易、调用合约

- 查询链上数据（余额、Gas 等）

- 编解码数据

### Anvil

本地以太坊节点（类似 Ganache），支持：

- 分叉主网/测试网
- 本地开发与调试
- 区块时间自定义

## 为什么选择 Foundry？

特性 |优势
----|---
速度极快| Rust 编写，编译/测试速度远超 JS 系工具（如 Hardhat）
原生 Solidity 测试 |无需 JS/Python，直接用 Solidity 写测试用例
高级测试功能| 内置 Fuzzing & Invariant Testing
开发者友好| 完整调试堆栈跟踪、Gas 跟踪、失败用例最小化

多链支持
Foundry 支持以太坊、Polygon和Binance Smart Chain、等多链协议，使开发者能跨平台构建应用，提升开发效率与灵活性。无论公有链或私有链，均能提供一致的开发体验。

## Foundry与Hardhat对比

### Foundry：轻量级，命令行工具

Foundry是一个轻量级、高性能的solidity开发框架，基于Rust编写，支持快速增量编译。其设计简洁高效，学习曲线高，所有操作（编译、测试、部署）通过命令行完成，极大提升了开发效率

编译和测试速度快

### Hardhat：全面，插件生态丰富

Hardhat是一个基于JavaScript的Ethereum开发框架，提供了丰富的插件，支持智能合约的测试、部署、调试、监控等功能。适合大型项目的Solidity开发框架

性能良好，但稍微慢一点

## 安装指南

### 1. 依赖项

Rust（必须）:

```bash
curl --proto '=https' --tlsv1.2 -sSf <https://sh.rustup.rs> | sh
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

### 2. 安装 Foundry

通过 foundryup 一键安装（Linux/macOS）：

```bash

# 下载安装 foundryup

curl -L https://foundry.paradigm.xyz | bash

# 加载环境变量（或重启终端）

source ~/.bashrc  # 或 source ~/.zshrc

# 安装依赖项
brew install libusb

# 安装/更新 Foundry

foundryup
```

### 3. 验证安装

```bash
forge --version
cast --version
anvil --version
```

输出类似：forge 0.2.0 (abcdef 2023-01-01)

## Windows 安装

### 安装 Rust

### 下载 foundryup.exe

```powershell
curl.exe -o foundryup.exe <https://foundry.paradigm.xyz/foundryup>
```

### 运行 foundryup.exe

### 将 %USERPROFILE%\.foundry\bin 加入系统 PATH

## 基本使用示例

### 初始化项目

```bash
forge init my_project
cd my_project
```

### 运行测试

```bash
forge test  # 运行所有测试
forge test -vvv  # 显示详细日志
```

### 启动本地节点

```bash
anvil  # 默认 <http://127.0.0.1:8545>
```

### 部署合约

```bash
forge create --rpc-url <RPC_URL> --private-key <PK> src/MyContract.sol:MyContract
```

## 常见问题

网络问题安装失败：尝试设置 Git 代理或手动下载二进制文件。
测试报错：确保 Solidity 版本匹配（在 foundry.toml 中配置）。
Fork 主网：

```bash
anvil --fork-url <https://eth-mainnet.g.alchemy.com/v2/YOUR_KEY>
```

官方文档：<https://book.getfoundry.sh/>
